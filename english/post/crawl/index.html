<!DOCTYPE html>
<html  dir="ltr" lang="en" data-theme=""><head>
    <title> Chi Feng | 爬虫项目 </title>

    
    <meta charset="utf-8"><meta name="generator" content="Hugo 0.92.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
    <meta name="description" content="差不多得了">
    
    
    
    <link rel="stylesheet"
        href="/css/main.min.cf3bc06a9d8faea75a336d59c26f1f005581c5797c997ea627faf957fef00abc.css"
        integrity="sha256-zzvAap2PrqdaM21Zwm8fAFWBxXl8mX6mJ/r5V/7wCrw="
        crossorigin="anonymous"
        type="text/css">
    
    
    <link rel="stylesheet"
        href="/css/markupHighlight.min.f798cbda9aaa38f89eb38be6414bd082cfd71a6780375cbf67b6d2fb2b96491e.css"
        integrity="sha256-95jL2pqqOPies4vmQUvQgs/XGmeAN1y/Z7bS&#43;yuWSR4="
        crossorigin="anonymous"
        type="text/css">
    
    <link rel="stylesheet" 
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" 
    integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" 
    crossorigin="anonymous" />
    
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">

    <link rel="canonical" href="/english/post/crawl/">

    
    
    
    
    <script type="text/javascript"
            src="/js/anatole-header.min.98b79432dfa53ecc682fb19247f797a316f8cbca9d5455c8bb22e58fc694b675.js"
            integrity="sha256-mLeUMt&#43;lPsxoL7GSR/eXoxb4y8qdVFXIuyLlj8aUtnU="
            crossorigin="anonymous"></script>


    
        
        
        <script type="text/javascript"
                src="/js/anatole-theme-switcher.min.7fd87181cdd7e8413aa64b6867bb32f3a8dc242e684fc7d5bbb9f600dbc2b6eb.js"
                integrity="sha256-f9hxgc3X6EE6pktoZ7sy86jcJC5oT8fVu7n2ANvCtus="
                crossorigin="anonymous"></script>
    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="爬虫项目"/>
<meta name="twitter:description" content="项目简介 本项目由公司前总经理承接，现已移交至复旦大学计算机学院维护(前领导于复旦大学任职教授)。
由于爬虫属于灰色业务，怕被人拿去之后乱用找我头上所以源码就不贴了，大致思路整明白。 仅供学习参考！
主体流程如下：
 中传悦动搭建数字图片保护平台-https://www.ccmgip.com/zh-CN/ipci 商家入住平台并上传原创图片申请保护 隐者公司通过水印技术对图片进行保护并存入数据库 全网（或针对指定网站）进行爬虫，获取图片并与受保护图片进行比对，对于疑似侵权图片发送预警报告  盈利模式为商家每年上传服务费，平台与隐者公司分成。"/>


    

</head>
<body>
<header><div class="page-top animated fadeInDown">
    <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
    </a>
    <nav>
        <ul class="nav__list" id="navMenu">
            <div class="nav__links">
                
                
                
            </div>
            <li>
                
                <a class="theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
                
            </li>
        </ul>
    </nav>
</div>
</header>
<div class="wrapper">
    <aside><div class="sidebar animated fadeInDown ">
    <div class="sidebar__content">
        <div class="logo-title">
            <div class="title">
                <img src="/images/avatar.jpg" alt="profile picture">
                <h3 title=""><a href="/">冯  驰</a></h3>
                <div class="description">
                    <p>差不多得了</p>
                </div>
            </div>
        </div>
        <ul class="social-links">
            
        </ul>
    </div><footer class="footer footer--sidebar">        
    <div class="by_farbox">
        <ul class="footer__list">
            <li class="footer__item">&copy;
                
                    Chi Feng 2024
                
            </li>
            
        </ul>
    </div>
</footer>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script></div>
</aside>
    <main>
        <div class="autopagerize_page_element">
            <div class="content">
    <div class="post  animated fadeInDown ">
        <div class="post-content">
            
            <div class="post-title">
                <h3>爬虫项目</h3>
                
            </div>

            <h1 id="项目简介">项目简介</h1>
<p>本项目由公司前总经理承接，现已移交至复旦大学计算机学院维护(前领导于复旦大学任职教授)。</p>
<p>由于爬虫属于灰色业务，怕被人拿去之后乱用找我头上所以源码就不贴了，大致思路整明白。
仅供学习参考！</p>
<p>主体流程如下：</p>
<ol>
<li>中传悦动搭建数字图片保护平台-https://www.ccmgip.com/zh-CN/ipci</li>
<li>商家入住平台并上传原创图片申请保护</li>
<li>隐者公司通过水印技术对图片进行保护并存入数据库</li>
<li>全网（或针对指定网站）进行爬虫，获取图片并与受保护图片进行比对，对于疑似侵权图片发送预警报告</li>
</ol>
<p>盈利模式为商家每年上传服务费，平台与隐者公司分成。</p>
<p>本人负责内容：
对电商网站的图片爬取，主要包括：京东商场/苏宁易购/当当网/唯品会/小红书/一号店（现已取消网页版）及一些新闻网站。<br>
本篇以电商网站 唯品会 为例，简要描述爬虫流程。
技术栈及所用工具：scrapy爬虫框架，postman模拟请求发送，redis比对去重，MongoDB数据存储</p>
<ol>
<li>确定爬虫思路
最终需要在商品详细页面获取图片，详情列表由分类查询进入，分类查询由主页分类栏进去，故流程如下：<br>
唯品会主页 ——&gt; 获取分类列表url存入本地(定期更新) ——&gt; 通过分类url获取商品详情url ——&gt; 通过商品详情url获取所有图片 ——&gt; redis中间件对比去重 ——&gt; 存入MongoDB数据库</li>
</ol>
<p>在网站首页获取有关分类的所有信息如下:<br>
<img src="/images/crawl/get_cate.png" alt="test">
直接复制相关内容标签到本地文档，读入后用bs4标准化到网页元素标签，套几个循环三级分类指向的url_ID： <br>
中间由于经历过到底是按分类爬取还是按店铺爬取的转型，最终为了如果在被侵权的情况下直接指向商家，选择按商家爬取。<br>
三级分类的所有商品详情页面里商家ID(本步骤可以直接获取图片但当前跳过)，并在记录后去重入库存存入本地文档。<br>
最终效果如下： 按列依次为 商铺id， 一级名称， 二级名称， 三级ID， 三级名称
<img src="/images/crawl/shop_list.png" alt="test">
以上商铺信息可以定期更新(一般为1个月)，终于可以开始详细信息图片爬取：<br>
可以根据商铺id直接进入商铺所有商品页面，但在翻页过程中url并不会发生变化。<br>
捕捉到每次翻页会有新的url发送，如下图所示，确定修改的参数为以每页120的变化（每页商品展示数）。<br>
<img src="/images/crawl/shop_to_goods.png" alt="test">
由该连接从postman中的模拟请求结果即为所有的商品id,可以同时在程序构建商品详情url：<br>
<img src="/images/crawl/all_goods.png" alt="test">
再次利用postman模拟请求，获取相关详情页的后台数据，经过处理后可以提取所有预览图与详细图名称：<br>
<img src="/images/crawl/get_imgs.png" alt="test">
获取url后进行redis去重，判定为新图后进行md5值计算和hash值计算，并获取所有所需信息进行返回：<br>
<img src="/images/crawl/deal_img.png" alt="test">
最终所有信息在scarpy的集合在items文件中：<br>
<img src="/images/crawl/items.png" alt="test">
pipline文件中设置数据库相关信息：<br>
<img src="/images/crawl/pipline.png" alt="test">
setting文件中设置请求头文件先关信息(一般也会设置每次单日爬虫访问500万个链接后停止)：<br>
<img src="/images/crawl/setting.png" alt="test"></p>
<p>差不多就是这个流程，关于ip代理部分暂未添加，可以在setting文件的头文件中设置代理ip，唯品会在反爬机制方面也没有限制。</p>
</div>
        <div class="post-footer">
            <div class="info">
                
                
            </div>
        </div>

        
    </div>


            </div>
        </div>
    </main>
</div><footer class="footer footer--base">        
    <div class="by_farbox">
        <ul class="footer__list">
            <li class="footer__item">&copy;
                
                    Chi Feng 2024
                
            </li>
            
        </ul>
    </div>
</footer>

<script type="text/javascript"
        src="/js/medium-zoom.min.83cb1dd5fea8d42d87d1e601a07faa73089ad0ef9ccfe5daf6041289ebcc4e46.js"
        integrity="sha256-g8sd1f6o1C2H0eYBoH&#43;qcwia0O&#43;cz&#43;Xa9gQSievMTkY="
        crossorigin="anonymous"></script></body>

</html>
